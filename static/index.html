<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grok — ваш корпоративный ассистент</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body>
    <div class="container">
        <div class="chat-header">
            <h1>Ромашка Grok</h1>
            <p>Внутренний ИИ-ассистент компании</p>
        </div>
        <div id="messages" class="messages"></div>
        <div class="input-area">
            <input type="text" id="userInput" placeholder="Напишите вопрос..." autofocus>
            <button id="sendBtn">Отправить</button>
        </div>
    </div>

    <script>
        const messagesDiv = document.getElementById('messages');
        const input = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');

        function addMessage(text, role) {
            const div = document.createElement('div');
            div.className = `message ${role}`;
            div.textContent = text;
            messagesDiv.appendChild(div);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function sendMessage() {
            const question = input.value.trim();
            if (!question) return;
            
            addMessage(question, 'user');
            input.value = '';
            sendBtn.disabled = true;

            try {
                const resp = await fetch('/ask', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question })
                });
                const data = await resp.json();
                addMessage(data.answer || "Ошибка ответа", 'assistant');
            } catch (e) {
                addMessage("Нет связи с сервером", 'assistant');
            }
            sendBtn.disabled = false;
            input.focus();
        }

        sendBtn.onclick = sendMessage;
        input.onkeypress = e => e.key === 'Enter' && sendMessage();

        // Приветствие
        addMessage("Привет! Я — ваш корпоративный Grok. Чем могу помочь?", 'assistant');
    </script>
</body>
</html>
